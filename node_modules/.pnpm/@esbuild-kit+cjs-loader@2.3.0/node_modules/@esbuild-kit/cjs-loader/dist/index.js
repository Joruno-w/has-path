"use strict";var g=require("path"),S=require("fs"),y=require("module"),n=require("@esbuild-kit/core-utils"),i=require("get-tsconfig");function f(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var p=f(g),T=f(S),u=f(y);const F=/^\.{0,2}\//,P=/\.[cm]?tsx?$/,b=`${p.default.sep}node_modules${p.default.sep}`,l=process.env.ESBK_TSCONFIG_PATH?{path:process.env.ESBK_TSCONFIG_PATH,config:i.parseTsconfig(process.env.ESBK_TSCONFIG_PATH)}:i.getTsconfig(),M=l==null?void 0:l.config,m=l&&i.createPathsMatcher(l),_=n.installSourceMapSupport(),r=process.versions.node.split(".").map(Number),O=r[0]>=13&&r[1]>=2||r[0]>=12&&r[1]>=20&&r[0]<13&&r[1]<0;function v(e,s){process.send&&process.send({type:"dependency",path:s});let t=T.default.readFileSync(s,"utf8");if(s.endsWith(".cjs")&&O){const o=n.transformDynamicImport(t);o&&(t=n.applySourceMap(o,s,_))}else{const o=n.transformSync(t,s,{tsconfigRaw:M});t=n.applySourceMap(o,s,_)}e._compile(t,s)}const h=u.default._extensions;[".js",".ts",".tsx",".jsx"].forEach(e=>{h[e]=v}),Object.defineProperty(h,".mjs",{value:v,enumerable:!1});const d=u.default._resolveFilename;u.default._resolveFilename=function(e,s,t,o){if(e.startsWith("node:")&&(e=e.slice(5)),m&&!F.test(e)&&!(s!=null&&s.filename.includes(b))){const c=m(e);for(const a of c)try{return d.call(this,a,s,t,o)}catch{}}if(s&&P.test(s.filename)){const c=n.resolveTsPath(e);if(c)try{return d.call(this,c,s,t,o)}catch(a){if(a.code!=="MODULE_NOT_FOUND")throw a}}return d.call(this,e,s,t,o)};
